"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3010],{26228:function(e,t,n){n.d(t,{Z:function(){return ew}});var i,r,o=n(25617),s=n(23284),a=n.n(s),u=n(78062),p=n(60915),c=n.n(p),l=n(83199),d=n(96434).Buffer;function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){m(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,S(i.key),i)}}function _(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e,t,n){return(t=S(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function S(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var N={DEFAULT_INSTANCE:"$default_instance",API_VERSION:2,MAX_STRING_LENGTH:4096,MAX_PROPERTY_KEYS:1e3,IDENTIFY_EVENT:"$identify",GROUP_IDENTIFY_EVENT:"$groupidentify",EVENT_LOG_URL:"api.amplitude.com",EVENT_LOG_EU_URL:"api.eu.amplitude.com",DYNAMIC_CONFIG_URL:"regionconfig.amplitude.com",DYNAMIC_CONFIG_EU_URL:"regionconfig.eu.amplitude.com",DEVICE_ID_INDEX:0,USER_ID_INDEX:1,OPT_OUT_INDEX:2,SESSION_ID_INDEX:3,LAST_EVENT_TIME_INDEX:4,EVENT_ID_INDEX:5,IDENTIFY_ID_INDEX:6,SEQUENCE_NUMBER_INDEX:7,COOKIE_TEST_PREFIX:"amp_cookie_test",COOKIE_PREFIX:"amp",STORAGE_DEFAULT:"",STORAGE_COOKIES:"cookies",STORAGE_NONE:"none",STORAGE_LOCAL:"localStorage",STORAGE_SESSION:"sessionStorage",REVENUE_EVENT:"revenue_amount",REVENUE_PRODUCT_ID:"$productId",REVENUE_QUANTITY:"$quantity",REVENUE_PRICE:"$price",REVENUE_REVENUE_TYPE:"$revenueType",AMP_DEVICE_ID_PARAM:"amp_device_id",AMP_REFERRER_PARAM:"amp_referrer",REFERRER:"referrer",REFERRING_DOMAIN:"referring_domain",UTM_SOURCE:"utm_source",UTM_MEDIUM:"utm_medium",UTM_CAMPAIGN:"utm_campaign",UTM_TERM:"utm_term",UTM_CONTENT:"utm_content",ATTRIBUTION_EVENT:"[Amplitude] Attribution Captured",TRANSPORT_HTTP:"http",TRANSPORT_BEACON:"beacon"},b=function(e){for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?t+=String.fromCharCode(i>>6|192)+String.fromCharCode(63&i|128):t+=String.fromCharCode(i>>12|224)+String.fromCharCode(i>>6&63|128)+String.fromCharCode(63&i|128)}return t},O=function(e){for(var t="",n=0,i=0,r=0;n<e.length;)(i=e.charCodeAt(n))<128?(t+=String.fromCharCode(i),n++):i>191&&i<224?(t+=String.fromCharCode((31&i)<<6|63&e.charCodeAt(n+1)),n+=2):(t+=String.fromCharCode((15&i)<<12|(63&e.charCodeAt(n+1))<<6|63&e.charCodeAt(n+2)),n+=3);return t},T="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==n.g?n.g:void 0,R={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){try{if(T.btoa&&T.atob)return T.btoa(unescape(encodeURIComponent(e)))}catch(e){}return R._encode(e)},_encode:function(e){var t,n,i,r,o,s,a,u="",p=0;for(e=b(e);p<e.length;)t=e.charCodeAt(p++),n=e.charCodeAt(p++),i=e.charCodeAt(p++),r=t>>2,o=(3&t)<<4|n>>4,s=(15&n)<<2|i>>6,a=63&i,isNaN(n)?s=a=64:isNaN(i)&&(a=64),u=u+R._keyStr.charAt(r)+R._keyStr.charAt(o)+R._keyStr.charAt(s)+R._keyStr.charAt(a);return u},decode:function(e){try{if(T.btoa&&T.atob)return decodeURIComponent(escape(T.atob(e)))}catch(e){}return R._decode(e)},_decode:function(e){var t,n,i,r,o,s,a,u="",p=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");p<e.length;)r=R._keyStr.indexOf(e.charAt(p++)),o=R._keyStr.indexOf(e.charAt(p++)),s=R._keyStr.indexOf(e.charAt(p++)),a=R._keyStr.indexOf(e.charAt(p++)),t=r<<2|o>>4,n=(15&o)<<4|s>>2,i=(3&s)<<6|a,u+=String.fromCharCode(t),64!==s&&(u+=String.fromCharCode(n)),64!==a&&(u+=String.fromCharCode(i));return O(u)}},A=Object.prototype.toString;function C(e){switch(A.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!=e?"nan":e&&1===e.nodeType?"element":void 0!==d&&"function"==typeof d.isBuffer&&d.isBuffer(e)?"buffer":(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e),v(e))}var k={DISABLE:0,ERROR:1,WARN:2,INFO:3},P=k.WARN,D={error:function(e){P>=k.ERROR&&U(e)},warn:function(e){P>=k.WARN&&U(e)},info:function(e){P>=k.INFO&&U(e)}},U=function(e){try{console.log("[Amplitude] "+e)}catch(e){}},w=function(e,t,n){return C(e)===n||(D.error("Invalid "+t+" input type. Expected "+n+" but received "+C(e)),!1)},M=function(e){var t=C(e);if("object"!==t)return D.error("Error: invalid properties format. Expecting Javascript object, received "+t+", ignoring"),{};if(Object.keys(e).length>N.MAX_PROPERTY_KEYS)return D.error("Error: too many properties (more than 1000), ignoring"),{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=i,o=C(r);"string"!==o&&(r=String(r),D.warn("WARNING: Non-string property key, received type "+o+', coercing to string "'+r+'"'));var s=q(r,e[i]);null!==s&&(n[r]=s)}return n},x=["nan","function","arguments","regexp","element"],q=function e(t,n){var i=C(n);if(-1!==x.indexOf(i))D.warn('WARNING: Property key "'+t+'" with invalid value type '+i+", ignoring"),n=null;else if("undefined"===i)n=null;else if("error"===i)n=String(n),D.warn('WARNING: Property key "'+t+'" with value type error, coercing to '+n);else if("array"===i){for(var r=[],o=0;o<n.length;o++){var s=n[o],a=C(s);if("array"===a){D.warn("WARNING: Cannot have "+a+" nested in an array property value, skipping");continue}"object"===a?r.push(M(s)):r.push(e(t,s))}n=r}else"object"===i&&(n=M(n));return n},j=function(e,t){var n=C(t);if("string"===n)return t;if("date"===n||"number"===n||"boolean"===n)return t=String(t),D.warn("WARNING: Non-string groupName, received type "+n+', coercing to string "'+t+'"'),t;if("array"===n){for(var i=[],r=0;r<t.length;r++){var o=t[r],s=C(o);if("array"===s||"object"===s){D.warn("WARNING: Skipping nested "+s+" in array groupName");continue}"string"===s?i.push(o):("date"===s||"number"===s||"boolean"===s)&&(o=String(o),D.warn("WARNING: Non-string groupName, received type "+s+', coercing to string "'+o+'"'),i.push(o))}return i}D.warn("WARNING: Non-string groupName, received type "+n+". Please use strings or array of strings for groupName")},G={setLogLevel:function(e){Object.prototype.hasOwnProperty.call(k,e)&&(P=k[e])},log:D,isEmptyString:function(e){return!e||0===e.length},isWebWorkerEnvironment:function(){return"undefined"!=typeof WorkerGlobalScope},getQueryParam:function(e,t){var n=RegExp("[\\?&]"+(e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]"))+"=([^&#]*)").exec(t);return null===n?void 0:decodeURIComponent(n[1].replace(/\+/g," "))},truncate:function e(t){if("array"===C(t))for(var n,i=0;i<t.length;i++)t[i]=e(t[i]);else if("object"===C(t))for(var r in t)r in t&&(t[r]=e(t[r]));else t="string"===C(n=t)&&n.length>N.MAX_STRING_LENGTH?n.substring(0,N.MAX_STRING_LENGTH):n;return t},validateGroups:function(e){var t=C(e);if("object"!==t)return D.error("Error: invalid groups format. Expecting Javascript object, received "+t+", ignoring"),{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=i,o=C(r);"string"!==o&&(r=String(r),D.warn("WARNING: Non-string groupType, received type "+o+', coercing to string "'+r+'"'));var s=j(r,e[i]);null!==s&&(n[r]=s)}return n},validateInput:w,validateProperties:M,validateDeviceId:function(e){return!!w(e,"deviceId","string")&&(!(e.indexOf(".")>=0)||(D.error("Device IDs may not contain '.' characters. Value will be ignored: \"".concat(e,'"')),!1))},validateTransport:function(e){return!!w(e,"transport","string")&&(e!==N.TRANSPORT_HTTP&&e!==N.TRANSPORT_BEACON?(D.error("transport value must be one of '".concat(N.TRANSPORT_BEACON,"' or '").concat(N.TRANSPORT_HTTP,"'")),!1):e===N.TRANSPORT_HTTP||"undefined"==typeof navigator||!!navigator.sendBeacon||(D.error("browser does not support sendBeacon, so transport must be HTTP"),!1))},validateSessionId:function(e){return!!(w(e,"sessionId","number")&&new Date(e).getTime()>0)||(D.error("sessionId value must in milliseconds since epoch (Unix Timestamp)"),!1)},getLocation:function(){return T.location},getHost:function(e){var t=T.location?T.location.hostname:"";if(e){if("undefined"!=typeof document){var n=document.createElement("a");return n.href=e,n.hostname||t}if("function"==typeof URL)return new URL(e).hostname||t}return t}},L=function(e){try{for(var t=document.cookie.split(";"),n=null,i=0;i<t.length;i++){for(var r=t[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e)){n=r.substring(e.length,r.length);break}}return n}catch(e){return null}},V=function(e,t,n){var i=null!==t?n.expirationDays:-1;if(i){var r=new Date;r.setTime(r.getTime()+864e5*i),i=r}var o=e+"="+t;i&&(o+="; expires="+i.toUTCString()),o+="; path=/",n.domain&&(o+="; domain="+n.domain),n.secure&&(o+="; Secure"),n.sameSite&&(o+="; SameSite="+n.sameSite),document.cookie=o},K=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.split(".")[N.LAST_EVENT_TIME_INDEX];return(n&&(e=parseInt(n,32)),e)?e:(G.log.warn("unable to parse malformed cookie: ".concat(t)),0)},F={set:V,get:L,getAll:function(e){try{var t,n=document.cookie.split(";").map(function(e){return e.trimStart()}),i=[],r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=E(e))){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(n);try{for(r.s();!(t=r.n()).done;){for(var o=t.value;" "===o.charAt(0);)o=o.substring(1);0===o.indexOf(e)&&i.push(o.substring(e.length))}}catch(e){r.e(e)}finally{r.f()}return i}catch(e){return[]}},sortByEventTime:function(e){return((function(e){if(Array.isArray(e))return I(e)})(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||E(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(e,t){var n=K(e);return K(t)-n})},areCookiesEnabled:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=N.COOKIE_TEST_PREFIX;if("undefined"==typeof document)return!1;var n=!1;try{var i=String(Date.now());V(t,i,e),G.log.info("Testing if cookies available"),n=L(t+"=")===i}catch(e){G.log.warn('Error thrown when checking for cookies. Reason: "'.concat(e,'"'))}finally{G.log.info("Cleaning up cookies availability test"),V(t,null,e)}return n}},X=function(){for(var e="",t=0;t<22;++t)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(Math.floor(64*Math.random()));return e},W=function(e){var t=G.getHost(e).split("."),n=[],i="_tldtest_"+X();if(G.isWebWorkerEnvironment())return"";for(var r=t.length-2;r>=0;--r)n.push(t.slice(r).join("."));for(var o=0;o<n.length;++o){var s=n[o],a={domain:"."+s};if(F.set(i,1,a),F.get(i))return F.set(i,null,a),s}return""},B={expirationDays:void 0,domain:void 0},Y=function(e){var t="";return B.domain&&(t="."===B.domain.charAt(0)?B.domain.substring(1):B.domain),e+t},H=function(e){var t=Y(e)+"=",n=F.get(t);try{if(n)return JSON.parse(R.decode(n))}catch(e){}return null},$=function(e,t){try{return F.set(Y(e),R.encode(JSON.stringify(t)),B),!0}catch(e){return!1}},Q=function(e){try{return F.set(Y(e),null,B),!0}catch(e){return!1}},J={reset:function(){B={expirationDays:void 0,domain:void 0}},options:function(e){if(0==arguments.length)return B;e=e||{},B.expirationDays=e.expirationDays,B.secure=e.secure,B.sameSite=e.sameSite;var t=G.isEmptyString(e.domain)?"."+W(G.getLocation().href):e.domain,n=Math.random();B.domain=t,$("amplitude_test",n);var i=H("amplitude_test");return i&&i===n||(t=null),Q("amplitude_test"),B.domain=t,B},get:H,set:$,remove:Q,setRaw:function(e,t){try{return F.set(Y(e),t,B),!0}catch(e){return!1}},getRaw:function(e){var t=Y(e)+"=";return F.get(t)}},z=function(){function e(){g(this,e),this.map=new Map,this.length=0}return _(e,[{key:"key",value:function(e){var t=Array.from(this.map.keys())[e];return this.map.get(t)}},{key:"getItem",value:function(e){return this.map.get(e)}},{key:"setItem",value:function(e,t){this.map.has(e)||(this.length+=1),this.map.set(e,t)}},{key:"removeItem",value:function(e){this.map.has(e)&&(this.length-=1,this.map.delete(e))}},{key:"clear",value:function(){this.map.clear(),this.length=0}}]),e}();if(function(){var e,t=new Date;try{return T.localStorage.setItem(t,t),e=T.localStorage.getItem(t)===String(t),T.localStorage.removeItem(t),e}catch(e){}return!1}())i=T.localStorage;else if(void 0!==T&&T.globalStorage)try{i=T.globalStorage[T.location.hostname]}catch(e){}else if("undefined"!=typeof document){var Z=document.createElement("div"),ee="localStorage";Z.style.display="none",document.getElementsByTagName("head")[0].appendChild(Z),Z.addBehavior&&(Z.addBehavior("#default#userdata"),i={length:0,setItem:function(e,t){Z.load(ee),!Z.getAttribute(e)&&this.length++,Z.setAttribute(e,t),Z.save(ee)},getItem:function(e){return Z.load(ee),Z.getAttribute(e)},removeItem:function(e){Z.load(ee),Z.getAttribute(e)&&this.length--,Z.removeAttribute(e),Z.save(ee)},clear:function(){Z.load(ee);for(var e,t=0;e=Z.XMLDocument.documentElement.attributes[t++];)Z.removeAttribute(e.name);Z.save(ee),this.length=0},key:function(e){return Z.load(ee),Z.XMLDocument.documentElement.attributes[e]}},Z.load(ee),i.length=Z.XMLDocument.documentElement.attributes.length)}else G.isWebWorkerEnvironment()&&(i=new z);i||(i={length:0,setItem:function(e,t){},getItem:function(e){},removeItem:function(e){},clear:function(){},key:function(e){}});var et=i,en=function(){this.storage=null};en.prototype.getStorage=function(e){if(null!==this.storage)return this.storage;if(!e&&F.areCookiesEnabled())this.storage=J;else{var t="amp_cookiestore_";this.storage={_options:{expirationDays:void 0,domain:void 0,secure:!1},reset:function(){this._options={expirationDays:void 0,domain:void 0,secure:!1}},options:function(e){return 0==arguments.length?this._options:(e=e||{},this._options.expirationDays=e.expirationDays||this._options.expirationDays,this._options.domain=e.domain||this._options.domain||T&&T.location&&T.location.hostname,this._options.secure=e.secure||!1)},get:function(e){try{return JSON.parse(et.getItem(t+e))}catch(e){}return null},set:function(e,n){try{return et.setItem(t+e,JSON.stringify(n)),!0}catch(e){}return!1},remove:function(e){try{et.removeItem(t+e)}catch(e){return!1}}}}return this.storage};var ei=(m(r={},N.STORAGE_COOKIES,!0),m(r,N.STORAGE_NONE,!0),m(r,N.STORAGE_LOCAL,!0),m(r,N.STORAGE_SESSION,!0),r),er=function(){function e(t){var n=t.storageKey,i=t.disableCookies,r=t.domain,o=t.secure,s=t.sameSite,a=t.expirationDays,u=t.storage;g(this,e),this.storageKey=n,this.domain=r,this.secure=o,this.sameSite=s,this.expirationDays=a,this.cookieDomain="";var p=G.getLocation()?G.getLocation().href:void 0,c=i?"":W(p);this.cookieDomain=r||(c?"."+c:null),ei[u]?this.storage=u:i||!F.areCookiesEnabled({domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays})?this.storage=N.STORAGE_LOCAL:this.storage=N.STORAGE_COOKIES}return _(e,[{key:"getCookieStorageKey",value:function(){if(!this.domain)return this.storageKey;var e="."===this.domain.charAt(0)?this.domain.substring(1):this.domain;return"".concat(this.storageKey).concat(e?"_".concat(e):"")}},{key:"save",value:function(e){var t=e.deviceId,n=e.userId,i=e.optOut,r=e.sessionId,o=e.lastEventTime,s=e.eventId,a=e.identifyId,u=e.sequenceNumber;if(this.storage!==N.STORAGE_NONE){var p=[t,R.encode(n||""),i?"1":"",r?r.toString(32):"0",o?o.toString(32):"0",s?s.toString(32):"0",a?a.toString(32):"0",u?u.toString(32):"0"].join(".");switch(this.storage){case N.STORAGE_SESSION:T.sessionStorage&&T.sessionStorage.setItem(this.storageKey,p);break;case N.STORAGE_LOCAL:et.setItem(this.storageKey,p);break;case N.STORAGE_COOKIES:this.saveCookie(p)}}}},{key:"saveCookie",value:function(e){F.set(this.getCookieStorageKey(),e,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays})}},{key:"load",value:function(){var e,t=this;if(this.storage===N.STORAGE_COOKIES){var n=this.getCookieStorageKey()+"=",i=F.getAll(n);if(0===i.length||1===i.length)e=i[0];else{var r=F.sortByEventTime(i)[0];i.forEach(function(){return F.set(t.getCookieStorageKey(),null,{})}),this.saveCookie(r),e=F.get(n)}}if(e||(e=et.getItem(this.storageKey)),!e)try{e=T.sessionStorage&&T.sessionStorage.getItem(this.storageKey)}catch(e){G.log.info('window.sessionStorage unavailable. Reason: "'.concat(e,'"'))}if(!e)return null;var o=e.split("."),s=null;if(o[N.USER_ID_INDEX])try{s=R.decode(o[N.USER_ID_INDEX])}catch(e){s=null}return{deviceId:o[N.DEVICE_ID_INDEX],userId:s,optOut:"1"===o[N.OPT_OUT_INDEX],sessionId:parseInt(o[N.SESSION_ID_INDEX],32),lastEventTime:parseInt(o[N.LAST_EVENT_TIME_INDEX],32),eventId:parseInt(o[N.EVENT_ID_INDEX],32),identifyId:parseInt(o[N.IDENTIFY_ID_INDEX],32),sequenceNumber:parseInt(o[N.SEQUENCE_NUMBER_INDEX],32)}}},{key:"clear",value:function(){var e;if(this.storage===N.STORAGE_COOKIES&&(e=F.get(this.getCookieStorageKey()+"="),F.set(this.getCookieStorageKey(),null,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:0})),e||(e=et.getItem(this.storageKey),et.clear()),!e)try{e=T.sessionStorage&&T.sessionStorage.getItem(this.storageKey),T.sessionStorage.clear()}catch(e){G.log.info('window.sessionStorage unavailable. Reason: "'.concat(e,'"'))}return!!e}}]),e}(),eo=function(e,t){var n=e?"?"+e.split(".").slice(-1)[0].replace(/\|/g,"&"):"",i=function(e,t,n,i){return G.getQueryParam(e,t)||G.getQueryParam(n,i)},r=i(N.UTM_SOURCE,t,"utmcsr",n),o=i(N.UTM_MEDIUM,t,"utmcmd",n),s=i(N.UTM_CAMPAIGN,t,"utmccn",n),a=i(N.UTM_TERM,t,"utmctr",n),u=i(N.UTM_CONTENT,t,"utmcct",n),p={},c=function(e,t){G.isEmptyString(t)||(p[e]=t)};return c(N.UTM_SOURCE,r),c(N.UTM_MEDIUM,o),c(N.UTM_CAMPAIGN,s),c(N.UTM_TERM,a),c(N.UTM_CONTENT,u),p},es="$clearAll",ea=function(){this.userPropertiesOperations={},this.properties=[]};ea.prototype.add=function(e,t){return"number"===C(t)||"string"===C(t)?this._addOperation("$add",e,t):G.log.error("Unsupported type for value: "+C(t)+", expecting number or string"),this},ea.prototype.append=function(e,t){return this._addOperation("$append",e,t),this},ea.prototype.clearAll=function(){return Object.keys(this.userPropertiesOperations).length>0?Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,es)||G.log.error("Need to send $clearAll on its own Identify object without any other operations, skipping $clearAll"):this.userPropertiesOperations[es]="-",this},ea.prototype.prepend=function(e,t){return this._addOperation("$prepend",e,t),this},ea.prototype.set=function(e,t){return this._addOperation("$set",e,t),this},ea.prototype.setOnce=function(e,t){return this._addOperation("$setOnce",e,t),this},ea.prototype.unset=function(e){return this._addOperation("$unset",e,"-"),this},ea.prototype.preInsert=function(e,t){return this._addOperation("$preInsert",e,t),this},ea.prototype.postInsert=function(e,t){return this._addOperation("$postInsert",e,t),this},ea.prototype.remove=function(e,t){return this._addOperation("$remove",e,t),this},ea.prototype._addOperation=function(e,t,n){if(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,es)){G.log.error("This identify already contains a $clearAll operation, skipping operation "+e);return}if(-1!==this.properties.indexOf(t)){G.log.error('User property "'+t+'" already used in this identify, skipping operation '+e);return}Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,e)||(this.userPropertiesOperations[e]={}),this.userPropertiesOperations[e][t]=n,this.properties.push(t)};var eu=function(e,t,n){this.url=e,this.data=t||{},this.headers=n};eu.prototype.send=function(e){if(T.XDomainRequest){var t=new T.XDomainRequest;t.open("POST",this.url,!0),t.onload=function(){e(200,t.responseText)},t.onerror=function(){"Request Entity Too Large"===t.responseText?e(413,t.responseText):e(500,t.responseText)},t.ontimeout=function(){},t.onprogress=function(){},t.send(u.Z.stringify(this.data))}else if("undefined"!=typeof XMLHttpRequest){var n=new XMLHttpRequest;n.open("POST",this.url,!0),n.onreadystatechange=function(){4===n.readyState&&e(n.status,n.responseText)},function(e,t){for(var n in t)("Cross-Origin-Resource-Policy"!==n||t[n])&&e.setRequestHeader(n,t[n])}(n,this.headers),n.send(u.Z.stringify(this.data))}else{var i=void 0;fetch(this.url,{method:"POST",headers:this.headers,body:u.Z.stringify(this.data)}).then(function(e){return i=e.status,e.text()}).then(function(t){e(i,t)})}};var ep=function(){this._price=null,this._productId=null,this._quantity=1,this._revenueType=null,this._properties=null};ep.prototype.setProductId=function(e){return"string"!==C(e)?G.log.error("Unsupported type for productId: "+C(e)+", expecting string"):G.isEmptyString(e)?G.log.error("Invalid empty productId"):this._productId=e,this},ep.prototype.setQuantity=function(e){return"number"!==C(e)?G.log.error("Unsupported type for quantity: "+C(e)+", expecting number"):this._quantity=parseInt(e),this},ep.prototype.setPrice=function(e){return"number"!==C(e)?G.log.error("Unsupported type for price: "+C(e)+", expecting number"):this._price=e,this},ep.prototype.setRevenueType=function(e){return"string"!==C(e)?G.log.error("Unsupported type for revenueType: "+C(e)+", expecting string"):this._revenueType=e,this},ep.prototype.setEventProperties=function(e){return"object"!==C(e)?G.log.error("Unsupported type for eventProperties: "+C(e)+", expecting object"):this._properties=G.validateProperties(e),this},ep.prototype._isValidRevenue=function(){return"number"===C(this._price)||(G.log.error("Invalid revenue, need to set price field"),!1)},ep.prototype._toJSONObject=function(){var e="object"===C(this._properties)?this._properties:{};return null!==this._productId&&(e[N.REVENUE_PRODUCT_ID]=this._productId),null!==this._quantity&&(e[N.REVENUE_QUANTITY]=this._quantity),null!==this._price&&(e[N.REVENUE_PRICE]=this._price),null!==this._revenueType&&(e[N.REVENUE_REVENUE_TYPE]=this._revenueType),e};var ec={US:"US",EU:"EU"},el=function(e){var t=N.EVENT_LOG_URL;switch(e){case ec.EU:t=N.EVENT_LOG_EU_URL;break;case ec.US:t=N.EVENT_LOG_URL}return t},ed=function(e){var t=N.DYNAMIC_CONFIG_URL;switch(e){case ec.EU:t=N.DYNAMIC_CONFIG_EU_URL;break;case ec.US:t=N.DYNAMIC_CONFIG_URL}return t},eh="8.21.9",ef={apiEndpoint:N.EVENT_LOG_URL,batchEvents:!1,cookieExpiration:365,cookieName:"amplitude_id",sameSiteCookie:"Lax",cookieForceUpgrade:!1,deferInitialization:!1,disableCookies:!1,deviceIdFromUrlParam:!1,domain:"",eventUploadPeriodMillis:3e4,eventUploadThreshold:30,forceHttps:!0,includeFbclid:!1,includeGclid:!1,includeReferrer:!1,includeUtm:!1,ingestionMetadata:{sourceName:"",sourceVersion:""},language:({getLanguage:function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage)||""}}).getLanguage(),library:{name:"amplitude-js",version:eh},logLevel:"WARN",logAttributionCapturedEvent:!1,optOut:!1,onError:function(){},onExitPage:function(){},onNewSessionStart:function(){},plan:{branch:"",source:"",version:"",versionId:""},platform:"Web",savedMaxCount:1e3,saveEvents:!0,saveParamsReferrerOncePerSession:!0,secureCookie:!1,sessionTimeout:18e5,storage:N.STORAGE_DEFAULT,trackingOptions:{city:!0,country:!0,carrier:!0,device_manufacturer:!0,device_model:!0,dma:!0,ip_address:!0,language:!0,os_name:!0,os_version:!0,platform:!0,region:!0,version_name:!0},transport:N.TRANSPORT_HTTP,unsetParamsReferrerOnNewSession:!1,unsentKey:"amplitude_unsent",unsentIdentifyKey:"amplitude_unsent_identify",uploadBatchSize:100,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","Cross-Origin-Resource-Policy":"cross-origin"},serverZone:ec.US,useDynamicConfig:!1,serverZoneBasedApi:!1,sessionId:null,partnerId:""},ev=new(function(){function e(){return g(this,e),e.instance||(this.ingestionEndpoint=N.EVENT_LOG_URL,e.instance=this),e.instance}return _(e,[{key:"refresh",value:function(e,t,n){var i="https";t||"https:"===T.location.protocol||(i="http");var r=i+"://"+ed(e),o=this;if(T.XDomainRequest){var s=new T.XDomainRequest;s.open("GET",r,!0),s.onload=function(){var e=JSON.parse(s.responseText);o.ingestionEndpoint=e.ingestionEndpoint,n&&n()},s.onerror=function(){},s.ontimeout=function(){},s.onprogress=function(){},s.send()}else{var a=new XMLHttpRequest;a.open("GET",r,!0),a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var e=JSON.parse(a.responseText);o.ingestionEndpoint=e.ingestionEndpoint,n&&n()}},a.send()}}}]),e}()),eg=function(e){(0,o.kP)()||G.isWebWorkerEnvironment()||G.log.warn("amplitude-js will not work in a non-browser environment. If you are planning to add Amplitude to a node environment, please use @amplitude/node"),this._instanceName=G.isEmptyString(e)?N.DEFAULT_INSTANCE:e.toLowerCase(),this._unsentEvents=[],this._unsentIdentifys=[],this.options=f(f({},ef),{},{headers:f({},ef.headers),ingestionMetadata:f({},ef.ingestionMetadata),library:f({},ef.library),plan:f({},ef.plan),trackingOptions:f({},ef.trackingOptions)}),this._q=[],this._sending=!1,this._updateScheduled=!1,this._onInitCallbacks=[],this._onNewSessionStartCallbacks=[],this._eventId=0,this._identifyId=0,this._lastEventTime=null,this._newSession=!1,this._sequenceNumber=0,this._sessionId=null,this._isInitialized=!1,this._connector=null,this._userAgent="undefined"!=typeof navigator&&navigator&&navigator.userAgent||null,this._ua=new(c())(this._userAgent).getResult()};eg.prototype.Identify=ea,eg.prototype.Revenue=ep,eg.prototype.init=function(e,t,n,i){var r=this;if("string"!==C(e)||G.isEmptyString(e)){G.log.error("Invalid apiKey. Please re-initialize with a valid apiKey");return}try{this._connector=l.V.getInstance(this._instanceName),e_(this.options,n),((0,o.kP)()||G.isWebWorkerEnvironment())&&void 0!==T.Prototype&&Array.prototype.toJSON&&((0,o.XQ)(),G.log.warn("Prototype.js injected Array.prototype.toJSON. Deleting Array.prototype.toJSON to prevent double-stringify")),this.options.cookieName!==ef.cookieName&&G.log.warn("The cookieName option is deprecated. We will be ignoring it for newer cookies"),this.options.serverZoneBasedApi&&(this.options.apiEndpoint=el(this.options.serverZone)),this._refreshDynamicConfig(),this.options.apiKey=e,this._storageSuffix="_"+e+(this._instanceName===N.DEFAULT_INSTANCE?"":"_"+this._instanceName),this._storageSuffixV5=e.slice(0,6),this._oldCookiename=this.options.cookieName+this._storageSuffix,this._unsentKey=this.options.unsentKey+this._storageSuffix,this._unsentIdentifyKey=this.options.unsentIdentifyKey+this._storageSuffix,this._cookieName=N.COOKIE_PREFIX+"_"+this._storageSuffixV5,this.cookieStorage=new en().getStorage(this.options.disableCookies),this.cookieStorage.options({expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie}),this._metadataStorage=new er({storageKey:this._cookieName,disableCookies:this.options.disableCookies,expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie,storage:this.options.storage});var s=!!this.cookieStorage.get(this._oldCookiename),a=!!this._metadataStorage.load();if(this._useOldCookie=!a&&s&&!this.options.cookieForceUpgrade,this.options.deferInitialization&&!(a||s)){this._deferInitialization(e,t,n,i);return}this.options.domain=this.cookieStorage.options().domain,"string"===C(this.options.logLevel)&&G.setLogLevel(this.options.logLevel);var u=eA(this);this._apiPropertiesTrackingOptions=Object.keys(u).length>0?{tracking_options:u}:{},this.options.cookieForceUpgrade&&s&&(a||eE(this),this.cookieStorage.remove(this._oldCookiename)),em(this),this._pendingReadStorage=!0,this.options.saveEvents&&(this._unsentEvents=this._loadSavedUnsentEvents(this.options.unsentKey).map(function(e){return{event:e}}).concat(this._unsentEvents),this._unsentIdentifys=this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).map(function(e){return{event:e}}).concat(this._unsentIdentifys)),n&&n.onNewSessionStart&&this.onNewSessionStart(this.options.onNewSessionStart),function(){n&&n.deviceId&&!G.validateDeviceId(n.deviceId)&&(G.log.error('Invalid device ID rejected. Randomly generated UUID will be used instead of "'.concat(n.deviceId,'"')),delete n.deviceId),r.options.deviceId=r._getInitialDeviceId(n&&n.deviceId,void 0),r.options.userId="string"===C(t)&&!G.isEmptyString(t)&&t||"number"===C(t)&&t.toString()||r.options.userId||null;var e=new Date().getTime(),i=!r._sessionId||!r._lastEventTime||e-r._lastEventTime>r.options.sessionTimeout||r.options.sessionId;i&&(r.options.unsetParamsReferrerOnNewSession&&r._unsetUTMParams(),r._newSession=!0,r._sessionId=r.options.sessionId||e,r.options.sessionId=void 0,r.options.saveParamsReferrerOncePerSession&&r._trackParamsAndReferrer()),r.options.saveParamsReferrerOncePerSession||r._trackParamsAndReferrer(),r.options.saveEvents&&(ey(r._unsentEvents),ey(r._unsentIdentifys)),r._lastEventTime=e,eS(r),r._pendingReadStorage=!1,r._sendEventsIfReady();for(var o=0;o<r._onInitCallbacks.length;o++)r._onInitCallbacks[o](r);r._onInitCallbacks=[],r._isInitialized=!0,i&&r._runNewSessionStartCallbacks()}(),this.runQueuedFunctions(),"function"===C(i)&&i(this);var p=this.options.onExitPage;if("function"===C(p)&&T.addEventListener&&!this.pageHandlersAdded){this.pageHandlersAdded=!0;var c=function(){var e=r.options.transport;r.setTransport(N.TRANSPORT_BEACON),p(),r.setTransport(e)};T.addEventListener("pagehide",function(){c()},!1)}this._connector.eventBridge.setEventReceiver(function(e){r._logEvent(e.eventType,e.eventProperties,e.userProperties)});var d=this._connector.identityStore.editIdentity();this.options.deviceId&&d.setDeviceId(this.options.deviceId),this.options.userId&&d.setUserId(this.options.userId),d.commit()}catch(e){G.log.error(e),n&&"function"===C(n.onError)&&n.onError(e)}},eg.prototype._runNewSessionStartCallbacks=function(){for(var e=0;e<this._onNewSessionStartCallbacks.length;e++)this._onNewSessionStartCallbacks[e](this)},eg.prototype.deleteLowerLevelDomainCookies=function(){var e=G.getHost(),t=this.options.domain&&"."===this.options.domain[0]?this.options.domain.slice(1):this.options.domain;if(t&&G.isWebWorkerEnvironment()&&e!==t&&RegExp(t+"$").test(e)){for(var n=e.split("."),i=t.split("."),r=n.length;r>i.length;--r){var o=n.slice(n.length-r).join(".");F.set(this._cookieName,null,{domain:"."+o})}F.set(this._cookieName,null,{})}},eg.prototype._getInitialDeviceId=function(e,t){if(e)return e;if(this.options.deviceIdFromUrlParam){var n=this._getDeviceIdFromUrlParam(this._getUrlParams());if(n)return n}return this.options.deviceId?this.options.deviceId:t||X()};var ey=function(e){for(var t=0;t<e.length;t++){var n=e[t].event.user_properties,i=e[t].event.event_properties,r=e[t].event.groups;e[t].event.user_properties=G.validateProperties(n),e[t].event.event_properties=G.validateProperties(i),e[t].event.groups=G.validateGroups(r)}};eg.prototype._trackParamsAndReferrer=function(){if(this.options.includeUtm&&(e=this._initUtmData()),this.options.includeReferrer&&(t=this._saveReferrer(this._getReferrer())),this.options.includeGclid&&(n=this._saveGclid(this._getUrlParams())),this.options.includeFbclid&&(i=this._saveFbclid(this._getUrlParams())),this.options.logAttributionCapturedEvent){var e,t,n,i,r=f(f(f(f({},e),t),n),i);Object.keys(r).length>0&&this.logEvent(N.ATTRIBUTION_EVENT,r)}};var e_=function e(t,n){if("object"===C(n)){var i=new Set(["headers"]),r=new Set(["eventUploadPeriodMillis"]);for(var o in n)i.has(o)?t[o]=f(f({},t[o]),n[o]):Object.prototype.hasOwnProperty.call(n,o)&&function(i){if(Object.prototype.hasOwnProperty.call(t,i)){var o=n[i],s=C(t[i]);if("transport"!==i||G.validateTransport(o)){if("sessionId"===i&&null!==o){t[i]=G.validateSessionId(o)?o:null;return}G.validateInput(o,i+" option",s)&&("boolean"===s?t[i]=!!o:"string"===s&&!G.isEmptyString(o)||"number"===s&&(o>0||0===o&&r.has(i))||"function"===s?t[i]=o:"object"===s&&e(t[i],o))}}}(o)}};eg.prototype.runQueuedFunctions=function(){var e=this._q;this._q=[];for(var t=0;t<e.length;t++){var n=this[e[t][0]];"function"===C(n)&&n.apply(this,e[t].slice(1))}},eg.prototype._apiKeySet=function(e){return!G.isEmptyString(this.options.apiKey)||(G.log.error("Invalid apiKey. Please set a valid apiKey with init() before calling "+e),!1)},eg.prototype._loadSavedUnsentEvents=function(e){var t=this._getFromStorage(et,e),n=this._parseSavedUnsentEventsString(t,e);return this._setInStorage(et,e,JSON.stringify(n)),n},eg.prototype._parseSavedUnsentEventsString=function(e,t){if(G.isEmptyString(e))return[];if("string"===C(e))try{var n=JSON.parse(e);if("array"===C(n))return n}catch(e){}return G.log.error("Unable to load "+t+" events. Restart with a new empty queue."),[]},eg.prototype.isNewSession=function(){return this._newSession},eg.prototype.onInit=function(e){this._isInitialized?e(this):this._onInitCallbacks.push(e)},eg.prototype.onNewSessionStart=function(e){this._onNewSessionStartCallbacks.push(e)},eg.prototype.getSessionId=function(){return this._sessionId},eg.prototype.nextEventId=function(){return this._eventId++,this._eventId},eg.prototype.nextIdentifyId=function(){return this._identifyId++,this._identifyId},eg.prototype.nextSequenceNumber=function(){return this._sequenceNumber++,this._sequenceNumber},eg.prototype._unsentCount=function(){return this._unsentEvents.length+this._unsentIdentifys.length},eg.prototype._sendEventsIfReady=function(){return 0!==this._unsentCount()&&(!this.options.batchEvents||this._unsentCount()>=this.options.eventUploadThreshold||this.options.transport===N.TRANSPORT_BEACON?(this.sendEvents(),!0):(this._updateScheduled||(this._updateScheduled=!0,setTimeout((function(){this._updateScheduled=!1,this.sendEvents()}).bind(this),this.options.eventUploadPeriodMillis)),!1))},eg.prototype.clearStorage=function(){return this._metadataStorage.clear()},eg.prototype._getFromStorage=function(e,t){return e.getItem(t+this._storageSuffix)},eg.prototype._setInStorage=function(e,t,n){e.setItem(t+this._storageSuffix,n)};var em=function(e){if(!e._useOldCookie){var t=e._metadataStorage.load();"object"===C(t)&&eI(e,t);return}var n=e.cookieStorage.get(e._oldCookiename);if("object"===C(n)){eI(e,n);return}},eE=function(e){var t=e.cookieStorage.get(e._oldCookiename);"object"===C(t)&&(eI(e,t),eS(e))},eI=function(e,t){t.deviceId&&(e.options.deviceId=t.deviceId),t.userId&&(e.options.userId=t.userId),null!==t.optOut&&void 0!==t.optOut&&!1!==t.optOut&&(e.options.optOut=t.optOut),t.sessionId&&(e._sessionId=parseInt(t.sessionId,10)),t.lastEventTime&&(e._lastEventTime=parseInt(t.lastEventTime,10)),t.eventId&&(e._eventId=parseInt(t.eventId,10)),t.identifyId&&(e._identifyId=parseInt(t.identifyId,10)),t.sequenceNumber&&(e._sequenceNumber=parseInt(t.sequenceNumber,10))},eS=function(e){var t={deviceId:e.options.deviceId,userId:e.options.userId,optOut:e.options.optOut,sessionId:e._sessionId,lastEventTime:e._lastEventTime,eventId:e._eventId,identifyId:e._identifyId,sequenceNumber:e._sequenceNumber};e._useOldCookie?e.cookieStorage.set(e.options.cookieName+e._storageSuffix,t):e._metadataStorage.save(t)};eg.prototype._initUtmData=function(e,t){e=e||this._getUrlParams();var n=eo(t=t||this.cookieStorage.get("__utmz"),e);return eN(this,n),n},eg.prototype._unsetUTMParams=function(){var e=new ea;e.unset(N.REFERRER),e.unset(N.REFERRING_DOMAIN),e.unset(N.UTM_SOURCE),e.unset(N.UTM_MEDIUM),e.unset(N.UTM_CAMPAIGN),e.unset(N.UTM_TERM),e.unset(N.UTM_CONTENT),this.identify(e)};var eN=function(e,t){if("object"===C(t)&&0!==Object.keys(t).length){var n=new ea;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n.setOnce("initial_"+i,t[i]),n.set(i,t[i]));e.identify(n)}};eg.prototype._getReferrer=function(){return this._getReferrerFromUrlParam(this._getUrlParams())||("undefined"!=typeof document?document.referrer:"")},eg.prototype._getUrlParams=function(){return T.location.search},eg.prototype._saveGclid=function(e){var t=G.getQueryParam("gclid",e);if(!G.isEmptyString(t)){var n={gclid:t};return eN(this,n),n}},eg.prototype._saveFbclid=function(e){var t=G.getQueryParam("fbclid",e);if(!G.isEmptyString(t)){var n={fbclid:t};return eN(this,n),n}},eg.prototype._getDeviceIdFromUrlParam=function(e){return G.getQueryParam(N.AMP_DEVICE_ID_PARAM,e)},eg.prototype._getReferrerFromUrlParam=function(e){return G.getQueryParam(N.AMP_REFERRER_PARAM,e)},eg.prototype._getReferringDomain=function(e){if(G.isEmptyString(e))return null;var t=e.split("/");return t.length>=3?t[2]:null},eg.prototype._saveReferrer=function(e){if(!G.isEmptyString(e)){var t={referrer:e,referring_domain:this._getReferringDomain(e)};return eN(this,t),t}},eg.prototype.saveEvents=function(){try{var e=JSON.stringify(this._unsentEvents.map(function(e){return e.event}));this._setInStorage(et,this.options.unsentKey,e)}catch(e){}try{var t=JSON.stringify(this._unsentIdentifys.map(function(e){return e.event}));this._setInStorage(et,this.options.unsentIdentifyKey,t)}catch(e){}},eg.prototype.setDomain=function(e){if(this._shouldDeferCall())return this._q.push(["setDomain"].concat(Array.prototype.slice.call(arguments,0)));if(G.validateInput(e,"domain","string"))try{this.cookieStorage.options({expirationDays:this.options.cookieExpiration,secure:this.options.secureCookie,domain:e,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,em(this),eS(this)}catch(e){G.log.error(e)}},eg.prototype.setUserId=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(G.validateInput(t,"startNewSession","boolean")){if(this._shouldDeferCall())return this._q.push(["setUserId"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.userId=null!=e&&""+e||null,t&&(this.options.unsetParamsReferrerOnNewSession&&this._unsetUTMParams(),this._newSession=!0,this._sessionId=new Date().getTime(),this._runNewSessionStartCallbacks(),this.options.saveParamsReferrerOncePerSession&&this._trackParamsAndReferrer()),eS(this),this._connector&&this._connector.identityStore.editIdentity().setUserId(this.options.userId).commit()}catch(e){G.log.error(e)}}},eg.prototype.setGroup=function(e,t){if(this._shouldDeferCall())return this._q.push(["setGroup"].concat(Array.prototype.slice.call(arguments,0)));if(!(!this._apiKeySet("setGroup()")||!G.validateInput(e,"groupType","string")||G.isEmptyString(e))){var n={};n[e]=t;var i=new ea().set(e,t);this._logEvent(N.IDENTIFY_EVENT,null,null,i.userPropertiesOperations,n,null,null,null)}},eg.prototype.setOptOut=function(e){if(this._shouldDeferCall())return this._q.push(["setOptOut"].concat(Array.prototype.slice.call(arguments,0)));if(G.validateInput(e,"enable","boolean"))try{this.options.optOut=e,eS(this)}catch(e){G.log.error(e)}},eg.prototype.setSessionId=function(e){if(G.validateInput(e,"sessionId","number"))try{this._sessionId=e,eS(this)}catch(e){G.log.error(e)}},eg.prototype.resetSessionId=function(){this.setSessionId(new Date().getTime())},eg.prototype.regenerateDeviceId=function(){if(this._shouldDeferCall())return this._q.push(["regenerateDeviceId"].concat(Array.prototype.slice.call(arguments,0)));this.setDeviceId(X())},eg.prototype.setDeviceId=function(e){if(this._shouldDeferCall())return this._q.push(["setDeviceId"].concat(Array.prototype.slice.call(arguments,0)));if(G.validateDeviceId(e))try{!G.isEmptyString(e)&&(this.options.deviceId=""+e,eS(this),this._connector&&this._connector.identityStore.editIdentity().setDeviceId(this.options.deviceId).commit())}catch(e){G.log.error(e)}},eg.prototype.setTransport=function(e){if(this._shouldDeferCall())return this._q.push(["setTransport"].concat(Array.prototype.slice.call(arguments,0)));G.validateTransport(e)&&(this.options.transport=e)},eg.prototype.setUserProperties=function(e){if(this._shouldDeferCall())return this._q.push(["setUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("setUserProperties()")&&G.validateInput(e,"userProperties","object")){var t=G.truncate(G.validateProperties(e));if(0!==Object.keys(t).length){var n=new ea;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.set(i,t[i]);this.identify(n)}}},eg.prototype.clearUserProperties=function(){if(this._shouldDeferCall())return this._q.push(["clearUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("clearUserProperties()")){var e=new ea;e.clearAll(),this.identify(e)}};var eb=function(e,t){for(var n=0;n<t._q.length;n++){var i=e[t._q[n][0]];"function"===C(i)&&i.apply(e,t._q[n].slice(1))}return e};eg.prototype.identify=function(e,t,n,i){if(this._shouldDeferCall())return this._q.push(["identify"].concat(Array.prototype.slice.call(arguments,0)));if(!this._apiKeySet("identify()")){ek(t,n,0,"No request sent",{reason:"API key is not set"});return}if("object"===C(e)&&Object.prototype.hasOwnProperty.call(e,"_q")&&(e=eb(new ea,e)),e instanceof ea){if(Object.keys(e.userPropertiesOperations).length>0)return this._logEvent(N.IDENTIFY_EVENT,null,null,e.userPropertiesOperations,null,null,null,t,n,i);ek(t,n,0,"No request sent",{reason:"No user property operations"})}else G.log.error("Invalid identify input type. Expected Identify object but saw "+C(e)),ek(t,n,0,"No request sent",{reason:"Invalid identify input type"})},eg.prototype.groupIdentify=function(e,t,n,i,r,o){if(this._shouldDeferCall())return this._q.push(["groupIdentify"].concat(Array.prototype.slice.call(arguments,0)));if(!this._apiKeySet("groupIdentify()")){ek(i,r,0,"No request sent",{reason:"API key is not set"});return}if(!G.validateInput(e,"group_type","string")||G.isEmptyString(e)){ek(i,r,0,"No request sent",{reason:"Invalid group type"});return}if(null==t){ek(i,r,0,"No request sent",{reason:"Invalid group name"});return}if("object"===C(n)&&Object.prototype.hasOwnProperty.call(n,"_q")&&(n=eb(new ea,n)),n instanceof ea){if(Object.keys(n.userPropertiesOperations).length>0)return this._logEvent(N.GROUP_IDENTIFY_EVENT,null,null,null,m({},e,t),n.userPropertiesOperations,null,i,r,o);ek(i,r,0,"No request sent",{reason:"No group property operations"})}else G.log.error("Invalid identify input type. Expected Identify object but saw "+C(n)),ek(i,r,0,"No request sent",{reason:"Invalid identify input type"})},eg.prototype.setVersionName=function(e){if(this._shouldDeferCall())return this._q.push(["setVersionName"].concat(Array.prototype.slice.call(arguments,0)));G.validateInput(e,"versionName","string")&&(this.options.versionName=e)},eg.prototype._logEvent=function(e,t,n,i,r,o,s,a,u,p){if(em(this),!e){ek(a,u,0,"No request sent",{reason:"Missing eventType"});return}if(this.options.optOut){ek(a,u,0,"No request sent",{reason:"optOut is set to true"});return}try{c=e===N.IDENTIFY_EVENT||e===N.GROUP_IDENTIFY_EVENT?this.nextIdentifyId():this.nextEventId();var c,l=this.nextSequenceNumber(),d="number"===C(s)?s:new Date().getTime();p?this._sessionId=-1:this._sessionId&&this._lastEventTime&&!(d-this._lastEventTime>this.options.sessionTimeout)||(this._sessionId=d,this._runNewSessionStartCallbacks()),this._lastEventTime=d,eS(this);var h=this._ua.browser.name,v=this._ua.browser.major,g=this._ua.device.model||this._ua.os.name,y=this._ua.device.vendor;i=i||{};var _=f({},this._apiPropertiesTrackingOptions);n=f(f({},n||{}),_),t=t||{},r=r||{},o=o||{};var m={device_id:this.options.deviceId,user_id:this.options.userId,timestamp:d,event_id:c,session_id:this._sessionId||-1,event_type:e,version_name:this.options.versionName||null,platform:eR(this,"platform")?this.options.platform:null,os_name:eR(this,"os_name")&&h||null,os_version:eR(this,"os_version")&&v||null,device_model:eR(this,"device_model")&&g||null,device_manufacturer:eR(this,"device_manufacturer")&&y||null,language:eR(this,"language")?this.options.language:null,api_properties:n,event_properties:G.truncate(G.validateProperties(t)),user_properties:G.truncate(G.validateProperties(i)),uuid:function e(t){return t?(t^16*Math.random()>>t/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e)}(),library:this.options.library,sequence_number:l,groups:G.truncate(G.validateGroups(r)),group_properties:G.truncate(G.validateProperties(o)),user_agent:this._userAgent,partner_id:this.options.partnerId||null};return eO(this)&&(m.plan={branch:this.options.plan.branch||void 0,source:this.options.plan.source||void 0,version:this.options.plan.version||void 0,versionId:this.options.plan.versionId||void 0}),eT(this)&&(m.ingestion_metadata={source_name:this.options.ingestionMetadata.sourceName||void 0,source_version:this.options.ingestionMetadata.sourceVersion||void 0}),e===N.IDENTIFY_EVENT||e===N.GROUP_IDENTIFY_EVENT?(this._unsentIdentifys.push({event:m,callback:a,errorCallback:u}),this._limitEventsQueued(this._unsentIdentifys)):(this._unsentEvents.push({event:m,callback:a,errorCallback:u}),this._limitEventsQueued(this._unsentEvents)),this.options.saveEvents&&this.saveEvents(),this._sendEventsIfReady(),e===N.IDENTIFY_EVENT&&this._connector&&this._connector.identityStore.editIdentity().updateUserProperties(G.truncate(G.validateProperties(i))).commit(),c}catch(e){G.log.error(e)}};var eO=function(e){return e.options.plan&&(e.options.plan.source||e.options.plan.branch||e.options.plan.version||e.options.plan.versionId)},eT=function(e){return e.options.ingestionMetadata&&(e.options.ingestionMetadata.sourceName||e.options.ingestionMetadata.sourceVersion)},eR=function(e,t){return!!e.options.trackingOptions[t]},eA=function(e){for(var t=["city","country","dma","ip_address","region"],n={},i=0;i<t.length;i++){var r=t[i];eR(e,r)||(n[r]=!1)}return n};eg.prototype._limitEventsQueued=function(e){e.length>this.options.savedMaxCount&&e.splice(0,e.length-this.options.savedMaxCount).forEach(function(e){ek(e.callback,e.errorCallback,0,"No request sent",{reason:"Event dropped because options.savedMaxCount exceeded. User may be offline or have a content blocker"})})},eg.prototype.logEvent=function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this._shouldDeferCall()?this._q.push(["logEvent"].concat(Array.prototype.slice.call(arguments,0))):this.logEventWithTimestamp(e,t,null,n,i,r)},eg.prototype.logEventWithTimestamp=function(e,t,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._shouldDeferCall()?this._q.push(["logEventWithTimestamp"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEvent()")?G.validateInput(e,"eventType","string")?G.isEmptyString(e)?(ek(i,r,0,"No request sent",{reason:"Missing eventType"}),-1):(G.validateInput(o,"outOfSession","boolean")||ek(i,r,0,"No request sent",{reason:"Invalid outOfSession value"}),this._logEvent(e,t,null,null,null,null,n,i,r,o)):(ek(i,r,0,"No request sent",{reason:"Invalid type for eventType"}),-1):(ek(i,r,0,"No request sent",{reason:"API key not set"}),-1)},eg.prototype.logEventWithGroups=function(e,t,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._shouldDeferCall()?this._q.push(["logEventWithGroups"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEventWithGroups()")?G.validateInput(e,"eventType","string")?(G.validateInput(o,"outOfSession","boolean")||ek(event.callback,event.errorCallback,0,"No request sent",{reason:"Invalid outOfSession value"}),this._logEvent(e,t,null,null,n,null,null,i,r,o)):(ek(event.callback,event.errorCallback,0,"No request sent",{reason:"Invalid type for eventType"}),-1):(ek(event.callback,event.errorCallback,0,"No request sent",{reason:"API key not set"}),-1)};var eC=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ek=function(e,t,n,i,r){"function"===C(e)&&e(n,i,r),"function"===C(t)&&t(n,i,r)};eg.prototype.logRevenueV2=function(e){if(this._shouldDeferCall())return this._q.push(["logRevenueV2"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("logRevenueV2()")){if("object"===C(e)&&Object.prototype.hasOwnProperty.call(e,"_q")&&(e=eb(new ep,e)),e instanceof ep){if(e&&e._isValidRevenue())return this.logEvent(N.REVENUE_EVENT,e._toJSONObject())}else G.log.error("Invalid revenue input type. Expected Revenue object but saw "+C(e))}},eg.prototype.logRevenue=function(e,t,n){return this._shouldDeferCall()?this._q.push(["logRevenue"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logRevenue()")&&eC(e)&&(void 0===t||eC(t))?this._logEvent(N.REVENUE_EVENT,{},{productId:n,special:"revenue_amount",quantity:t||1,price:e},null,null,null,null,null):-1},eg.prototype._logErrorsOnEvents=function(e,t,n,i){for(var r=["_unsentEvents","_unsentIdentifys"],o=0;o<r.length;o++)for(var s=r[o],a="_unsentEvents"===s?e:t,u=0;u<this[s].length;u++){var p=this[s][u];p.event.event_id<=a&&p.errorCallback&&p.errorCallback(n,i)}},eg.prototype.removeEvents=function(e,t,n,i){eP(this,"_unsentEvents",e,n,i),eP(this,"_unsentIdentifys",t,n,i)};var eP=function(e,t,n,i,r){if(!(n<0)){for(var o=[],s=0;s<e[t].length;s++){var a=e[t][s];a.event.event_id>n?o.push(a):a.callback&&a.callback(i,r)}e[t]=o}};eg.prototype.sendEvents=function(){if(!this._apiKeySet("sendEvents()")){this.removeEvents(1/0,1/0,0,"No request sent",{reason:"API key not set"});return}if(this.options.optOut){this.removeEvents(1/0,1/0,0,"No request sent",{reason:"Opt out is set to true"});return}if(0!==this._unsentCount()){if(this.options.transport!==N.TRANSPORT_BEACON){if(this._sending)return;this._sending=!0}var e=(this.options.forceHttps?"https":"https:"===T.location.protocol?"https":"http")+"://"+this.options.apiEndpoint,t=Math.min(this._unsentCount(),this.options.uploadBatchSize),n=this._mergeEventsAndIdentifys(t),i=n.maxEventId,r=n.maxIdentifyId,o=JSON.stringify(n.eventsToSend.map(function(e){return e.event})),s=new Date().getTime(),u={client:this.options.apiKey,e:o,v:N.API_VERSION,upload_time:s,checksum:a()(N.API_VERSION+this.options.apiKey+o+s)};if(this.options.transport===N.TRANSPORT_BEACON&&"undefined"!=typeof navigator){navigator.sendBeacon(e,new URLSearchParams(u))?(this.removeEvents(i,r,200,"success"),this.options.saveEvents&&this.saveEvents()):this._logErrorsOnEvents(i,r,0,"");return}var p=this;try{new eu(e,u,this.options.headers).send(function(e,n){p._sending=!1;try{200===e?(p.removeEvents(i,r,e,n),p.options.saveEvents&&p.saveEvents(),p._sendEventsIfReady()):(p._logErrorsOnEvents(i,r,e,n),413===e&&(1===p.options.uploadBatchSize&&p.removeEvents(i,r,e,n),p.options.uploadBatchSize=Math.ceil(t/2),p.sendEvents()))}catch(e){}})}catch(e){var c="Request failed to send";G.log.error(c),p._logErrorsOnEvents(i,r,0,c),p.removeEvents(i,r,0,c,{reason:e.message})}}},eg.prototype._mergeEventsAndIdentifys=function(e){for(var t=[],n=0,i=-1,r=0,o=-1;t.length<e;){var s=void 0,a=r>=this._unsentIdentifys.length,u=n>=this._unsentEvents.length;if(u&&a){G.log.error("Merging Events and Identifys, less events and identifys than expected");break}a?i=(s=this._unsentEvents[n++]).event.event_id:u?o=(s=this._unsentIdentifys[r++]).event.event_id:"sequence_number"in this._unsentEvents[n].event&&!(this._unsentEvents[n].event.sequence_number<this._unsentIdentifys[r].event.sequence_number)?o=(s=this._unsentIdentifys[r++]).event.event_id:i=(s=this._unsentEvents[n++]).event.event_id,t.push(s)}return{eventsToSend:t,maxEventId:i,maxIdentifyId:o}},eg.prototype.setGlobalUserProperties=function(e){this.setUserProperties(e)},eg.prototype.__VERSION__=function(){return this.options.library.version},eg.prototype.setLibrary=function(e,t){null!=e&&(this.options.library.name=e),null!=t&&(this.options.library.version=t)},eg.prototype._shouldDeferCall=function(){return this._pendingReadStorage||this._initializationDeferred},eg.prototype._deferInitialization=function(){this._initializationDeferred=!0,this._q.push(["init"].concat(Array.prototype.slice.call(arguments,0)))},eg.prototype.enableTracking=function(){this._initializationDeferred=!1,eS(this),this.runQueuedFunctions()},eg.prototype._refreshDynamicConfig=function(){this.options.useDynamicConfig&&ev.refresh(this.options.serverZone,this.options.forceHttps,(function(){this.options.apiEndpoint=ev.ingestionEndpoint}).bind(this))},eg.prototype.getDeviceId=function(){return this.options.deviceId},eg.prototype.getUserId=function(){return this.options.userId},eg.prototype.setMinTimeBetweenSessionsMillis=function(e){if(G.validateInput(e,"timeInMillis","number")){if(this._shouldDeferCall())return this._q.push(["setMinTimeBetweenSessionsMillis"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.sessionTimeout=e}catch(e){G.log.error(e)}}},eg.prototype.setEventUploadThreshold=function(e){if(G.validateInput(e,"eventUploadThreshold","number")){if(this._shouldDeferCall())return this._q.push(["setEventUploadThreshold"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.eventUploadThreshold=e}catch(e){G.log.error(e)}}},eg.prototype.setUseDynamicConfig=function(e){if(G.validateInput(e,"useDynamicConfig","boolean")){if(this._shouldDeferCall())return this._q.push(["setUseDynamicConfig"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.useDynamicConfig=e,this._refreshDynamicConfig()}catch(e){G.log.error(e)}}},eg.prototype.setServerZone=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if((e===ec.EU||e===ec.US)&&G.validateInput(t,"serverZoneBasedApi","boolean")){if(this._shouldDeferCall())return this._q.push(["setServerZone"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.serverZone=e,this.options.serverZoneBasedApi=t,t&&(this.options.apiEndpoint=el(this.options.serverZone))}catch(e){G.log.error(e)}}},eg.prototype.setServerUrl=function(e){if(G.validateInput(e,"serverUrl","string")){if(this._shouldDeferCall())return this._q.push(["setServerUrl"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.apiEndpoint=e}catch(e){G.log.error(e)}}};var eD=function(){this.options=f({},ef),this._q=[],this._instances={}};eD.prototype.Identify=ea,eD.prototype.Revenue=ep,eD.prototype.getInstance=function(e){e=G.isEmptyString(e)?N.DEFAULT_INSTANCE:e.toLowerCase();var t=this._instances[e];return void 0===t&&(t=new eg(e),this._instances[e]=t),t},eD.prototype.init=function(e,t,n,i){this.getInstance().init(e,t,n,(function(e){this.options=e.options,"function"===C(i)&&i(e)}).bind(this))},eD.prototype.isNewSession=function(){return this.getInstance().isNewSession()},eD.prototype.getSessionId=function(){return this.getInstance().getSessionId()},eD.prototype.nextEventId=function(){return this.getInstance().nextEventId()},eD.prototype.nextIdentifyId=function(){return this.getInstance().nextIdentifyId()},eD.prototype.nextSequenceNumber=function(){return this.getInstance().nextSequenceNumber()},eD.prototype.saveEvents=function(){this.getInstance().saveEvents()},eD.prototype.setDomain=function(e){this.getInstance().setDomain(e)},eD.prototype.setUserId=function(e){this.getInstance().setUserId(e)},eD.prototype.setGroup=function(e,t){this.getInstance().setGroup(e,t)},eD.prototype.setOptOut=function(e){this.getInstance().setOptOut(e)},eD.prototype.regenerateDeviceId=function(){this.getInstance().regenerateDeviceId()},eD.prototype.setDeviceId=function(e){this.getInstance().setDeviceId(e)},eD.prototype.setUserProperties=function(e){this.getInstance().setUserProperties(e)},eD.prototype.clearUserProperties=function(){this.getInstance().clearUserProperties()},eD.prototype.identify=function(e,t){this.getInstance().identify(e,t)},eD.prototype.setVersionName=function(e){this.getInstance().setVersionName(e)},eD.prototype.logEvent=function(e,t,n){return this.getInstance().logEvent(e,t,n)},eD.prototype.logEventWithGroups=function(e,t,n,i){return this.getInstance().logEventWithGroups(e,t,n,i)},eD.prototype.logRevenueV2=function(e){return this.getInstance().logRevenueV2(e)},eD.prototype.logRevenue=function(e,t,n){return this.getInstance().logRevenue(e,t,n)},eD.prototype.removeEvents=function(e,t){this.getInstance().removeEvents(e,t)},eD.prototype.sendEvents=function(e){this.getInstance().sendEvents(e)},eD.prototype.setGlobalUserProperties=function(e){this.getInstance().setUserProperties(e)},eD.prototype.__VERSION__=eh;var eU=void 0!==T&&T.amplitude||{},ew=new eD;for(var eM in ew._q=eU._q||[],eU._iq)Object.prototype.hasOwnProperty.call(eU._iq,eM)&&(ew.getInstance(eM)._q=eU._iq[eM]._q||[])}}]);
//# sourceMappingURL=d16ac788-a1857d47473362f1.js.map